import requests
from bs4 import BeautifulSoup
from colorama import Fore, Style

def search_exploits(query):
    try:
        url = f"https://www.exploit-db.com/search?q={query}"
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
        }
        response = requests.get(url, headers=headers)
        
        if response.status_code == 200:
            soup = BeautifulSoup(response.text, 'html.parser')
            exploits = []
            
            table = soup.find('table', {'class': 'exploit_list'})
            if table:
                rows = table.find_all('tr')[1:]  # Skip header row
                for row in rows:
                    cols = row.find_all('td')
                    if len(cols) >= 6:
                        exploit = {
                            'id': cols[1].text.strip(),
                            'title': cols[2].text.strip(),
                            'type': cols[3].text.strip(),
                            'platform': cols[4].text.strip(),
                            'date': cols[5].text.strip(),
                            'url': 'https://www.exploit-db.com' + cols[2].find('a')['href']
                        }
                        exploits.append(exploit)
            return exploits
        return None
    except Exception:
        return None

def main():
    print(Fore.YELLOW + "\n[+] Exploit Search Module" + Style.RESET_ALL)
    query = input(Fore.CYAN + "[?] Enter search query (product/software): " + Style.RESET_ALL).strip()
    
    print(Fore.BLUE + "[*] Searching exploits..." + Style.RESET_ALL)
    exploits = search_exploits(query)
    
    if exploits:
        print(Fore.GREEN + f"\n[+] Found {len(exploits)} exploits:" + Style.RESET_ALL)
        for exploit in exploits:
            print(Fore.CYAN + f"\n[ID: {exploit['id']}] {exploit['title']}" + Style.RESET_ALL)
            print(Fore.YELLOW + f"  Type: {exploit['type']} | Platform: {exploit['platform']} | Date: {exploit['date']}")
            print(Fore.CYAN + f"  URL: {exploit['url']}" + Style.RESET_ALL)
    else:
        print(Fore.RED + "\n[-] No exploits found" + Style.RESET_ALL)
    
    input(Fore.CYAN + "\n[?] Press Enter to return to main menu..." + Style.RESET_ALL)
